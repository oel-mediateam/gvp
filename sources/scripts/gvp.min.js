/* global videojs */$(document).ready(function(){function o(e){var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t),r=n.exec(window.location.href);e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");return r===null?"":decodeURIComponent(r[1].replace(/\+/g," "))}function u(e){var t=e,n=t.split(" "),r,i,s,o=[],u;for(s=0;s<n.length;s++){r=n[s].substring(0,1).toUpperCase();i=n[s].substring(1);o[s]=r+i}u=o.join(" ");return u}function a(){$.trim(o("ttl"))!==""&&$(".title_bar").html(u($.trim(o("ttl")).replace(/\_+/g," ")));$.trim(o("intro"))!==""&&Number($.trim(o("intro")))&&(n=$.trim(o("intro")));$.trim(o("w"))!==""&&(e=Number($.trim(o("w"))));$.trim(o("h"))!==""&&(t=Number($.trim(o("h"))))}function f(){var e=window.location.href,t;t=e.split("?");t=t[0].split("/");t=t[t.length-2];s=t}function l(){$(".video_holder").html('<video id="gvp_video" class="video-js vjs-default-skin" controls preload="metadata" poster="'+s+'.jpg"></video>');videojs("gvp_video",{},function(){r=this;this.progressTips();this.width(e);this.height(t);this.src([{type:"video/mp4",src:"https://mediastreamer.doit.wisc.edu/uwli-ltc/media/intro_videos/"+n+".mp4"},{type:"video/ogg",src:"https://mediastreamer.doit.wisc.edu/uwli-ltc/media/intro_videos/"+n+".ogv"}])});r.on("error",function(){});r.on("ended",function(){this.dispose();c()})}function c(r){if(typeof r=="undefined"||typeof r===null)r=!1;r?$(".video_holder").html('<video id="gvp_video" class="video-js vjs-default-skin" controls poster="'+s+'.jpg"><track src="'+s+'.vtt" kind="subtitles" srcland="en" label="English" default /></video>'):$(".video_holder").html('<video id="gvp_video" class="video-js vjs-default-skin" controls><track src="'+s+'.vtt" kind="subtitles" srcland="en" label="English" default /></video>');videojs("gvp_video",{},function(){i=this;this.progressTips();this.width(e);this.height(t);this.src([{type:"video/mp4",src:s+".mp4"},{type:"video/ogg",src:s+".ogv"}]);n&&this.play()});i.on("error",function(){});i.on("ended",function(){this.currentTime(0);$(".vjs-poster").delay(6e3).queue(function(){$(this).css("background-image","url("+s+".jpg)").html('<span class="replay-button"></span>').show()})})}function h(e,t){var n;t==="pdf"?n="application/pdf":t==="mp3"?n="audio/mpeg":t==="mp4"&&(n="video/mp4");$.ajax({url:e+"."+t,type:"HEAD",dataType:"text",contentType:n,async:!1,beforeSend:function(e){e.overrideMimeType(n);e.setRequestHeader("Accept",n)},success:function(){var n=e,r=$("#download_bar ul");if(location.protocol!=="http:"){var i=window.location.href;i=i.substr(0,i.lastIndexOf("/")+1).replace("https","http");n=i+e}t==="pdf"?r.append('<li><a href="'+n+"."+t+'" target="_blank">Transcript</a></li>'):t==="mp3"?r.append('<li><a href="'+n+"."+t+'" target="_blank">MP3</a></li>'):t==="mp4"&&r.append('<li><a href="'+n+"."+t+'" target="_blank">Video</a></li>')},error:function(){var e;t==="mp3"?e="MP3":t==="mp4"&&(e="Video");if(t!=="pdf"){e+=" pending...";$("#download_bar ul").before("<p>"+e+"</p>")}}})}function p(){h(s,"mp4");h(s,"mp3");h(s,"pdf")}function d(){var e=navigator.userAgent,t={ios:e.match(/(iPad|iPhone|iPod)/g),blackberry:e.match(/BlackBerry/),android:e.match(/Android/),window:e.match(/IEMobile/)};return t.ios||t.blackberry||t.android?!0:!1}function v(){$(document).attr("title",$(".title_bar").html().length<=0?u($.trim(s.replace(/\_+/g," "))):$(".title_bar").html());$(".gvp_wrapper").css({width:e+"px",height:t+"px"});$(".title_bar").css("width",e-30+"px");if(!d()||o("m")!==0&&o("m")!==""){n?l():c(!0);$(".video_holder").click(function(){$(".title_bar").hide()})}else $(".video_holder").css({"background-image":"url("+s+".jpg)",width:e+"px",height:t+"px",cursor:"pointer"}).html('<span class="newWindow-button"></span>').on("click",function(){var e=window.location.href;e=e.replace("https","http").replace(/intro=[0-9]+/g,"intro=0");window.location.search?e+="&m=1":e+="?m=1";window.open(e)})}var e=640,t=360,n=0,r,i,s;a();f();v();p()});